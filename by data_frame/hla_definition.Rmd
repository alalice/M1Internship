---
title: "Exploration DIVAT hla_definition"
author: "alice"
date: "2024-04-16"
output: html_document
---

```{r}
suppressWarnings(library(Hmisc))
suppressWarnings(library(readxl))
coltype <- c("numeric",rep("guess",56))
suppressWarnings(hla_definition <- read_excel("C:\\Alice\\1-Universitée\\Stages\\M1-centrale\\DATAS\\ALICE_DATAS\\ALL_VARIABLES_KiTGENIE2024.xlsx", sheet = "hla_definition",na = "NA",col_types = coltype))
```

R_PRG390 : efs_a2 = - (removed in the data frame, is it a NA ?)

```{r}
hla_def_Nantes <- hla_definition[complete.cases(hla_definition$id_ind),]
```

```{r}
hla_def_Nantes <- hla_def_Nantes[,-c(16:57)]
hla_def_Nantes <- hla_def_Nantes[,-c(8,9,12:15)]
```

```{r}
describe(hla_def_Nantes)
```

```{r}
dataframe <- data.frame(row.names = c("missing","part","coments") )
lenght <- length(hla_def_Nantes$id_ind)
for (col in names(hla_def_Nantes)) {
  if(sum(is.na(hla_def_Nantes[[col]]))!= 0){
    cat(col ,":" , sum(is.na(hla_def_Nantes[[col]])/lenght),"\n")}
    #dataframe[col] <- c(sum(is.na(hla_def_Nantes[[col]])),sum(is.na(hla_def_Nantes[[col]]))/lenght,"random")}
}
```

```{r}
write.xlsx(dataframe, file = "C:\\Alice\\1-Universitée\\Stages\\M1-centrale\\DATAS\\Describe\\explore\\explore_NA.xlsx",sheetName = "hla_definition", append = TRUE)
```
remove the columns from 16 to 57 as there are all completely empty.

```{r}
hla_def_Nantes <- hla_def_Nantes[,-c(16:57)]
```

Missing (NA) : 

divat_a1 : 12 -> replace by random ? 
divat_a2 : 12 -> replace by random ? 
divat_b1 : 13 -> replace by random ? 
divat_b2 : 12 -> replace by random ? 
divat_dr1 : 13 -> replace by random ? 
divat_dr2 : 13 -> replace by random ? 
divat_dqa1 : 6156 -> many values missing 
divat_dqa2 : 6156 -> many values missing 
divat_dq1 : 541 -> replace by random ?
divat_dq2 : 543 -> replace by random ? 
divat_cw1 : 5138 -> many values missing 
divat_cw2 : 5139 -> many values missing 
divat_dp1 : 5414 -> many values missing 
divat_dp2 : 5414 -> many values missing 

```{r}
addWorksheet(OUT, "hla_def")
writeData(OUT, sheet = "hla_def", x = hla_def_Nantes,keepNA = TRUE)
```

```{r}
summary(hla_definition)
```

